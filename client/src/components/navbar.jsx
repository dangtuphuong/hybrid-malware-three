import AuthService from '../services/auth-service';
import { useNavigate } from "react-router-dom";
import { useCallback } from 'react';

const NavBar = () => {
    const navigate = useNavigate();

    const onLogout = useCallback((e) => {
        e?.preventDefault();
        AuthService.logout().then(
          () => navigate("/"),
          (error) => {
            console.log(error);
          }
        );
      }, []);

    return (
        <div className={`bg-main h-16 fixed inset-x-0 top-0 flex border-b items-center`}>
            <div className={`w-1/5`}>
                { AuthService.getCurrentUser() &&
                    <p className={`px-4 font-medium`}>
                        Welcome, {AuthService.getCurrentUser().name}
                    </p>
                }
            </div>
            <div className={`w-3/5 flex gap-2 justify-center`}>
                <button className={`px-4 py-2 hover:bg-cyan-500 rounded-md hover:shadow-lg hover:shadow-cyan-500/40 hover:font-medium hover:text-zinc-50 transition duration-100`} onClick={() => navigate('/home')}>Home</button>
                { AuthService.getCurrentUser() && 
                    <div className={`flex gap-2`}>
                        <span className={`p-2`}>|</span>
                        <button className={`px-4 py-2 hover:bg-cyan-500 rounded-md hover:shadow-lg hover:shadow-cyan-500/40 hover:font-medium hover:text-zinc-50 transition duration-100`} onClick={() => navigate('/train')}>Training</button>
                        <span className={`p-2`}>|</span>
                        <button className={`${AuthService.getCurrentUser()?.role !== 1 ? 'hidden' : ''} px-4 py-2 hover:shadow-lg hover:shadow-cyan-500/40 hover:bg-cyan-500 rounded-md hover:font-medium hover:text-zinc-50 transition duration-100`} onClick={() => navigate('/predict')}>Predicting</button>
                        <span className={`p-2`}>|</span>
                        <button className={`px-4 py-2 hover:shadow-lg hover:shadow-cyan-500/40 hover:bg-cyan-500 rounded-md hover:font-medium hover:text-zinc-50 transition duration-100`} onClick={() => navigate('/compare')}>Comparing</button>
                    </div>
                }
            </div>
            <div className={`px-5 w-1/5 flex justify-end`}>
                { AuthService.getCurrentUser() ?
                    <div>   
                        <button className={`px-5 py-2 border border-zinc-500 rounded-full hover:bg-zinc-600 hover:text-zinc-50 hover:font-medium transition duration-100`} onClick={onLogout}>Sign out</button>
                    </div>
                    :
                    <div className={`flex gap-6`}>
                        <button className={`px-5 py-2 bg-cyan-400 text-zinc-50 rounded-full hover:bg-cyan-500 hover:text-zinc-50 hover:font-medium transition duration-100`} onClick={() => navigate('/login')}>Sign in</button>
                        <button className={`px-5 py-2 border border-zinc-500 rounded-md hover:bg-zinc-600 hover:text-zinc-50 hover:font-medium transition duration-100`} onClick={() => navigate('/register')}>Sign up</button>
                    </div>
                }
            </div>
        </div>
    )
}

export default NavBar;